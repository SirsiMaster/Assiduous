#!/bin/bash

# Prepare commit message hook
# Adds helpful reminders about conventional commits and versioning

COMMIT_MSG_FILE=$1
COMMIT_SOURCE=$2
SHA1=$3

# Only add template for new commits (not amends, merges, etc.)
if [ -z "$COMMIT_SOURCE" ]; then
    # Check if the message already has content
    if [ ! -s "$COMMIT_MSG_FILE" ]; then
        cat > "$COMMIT_MSG_FILE" << 'EOF'
# <type>(<scope>): <subject>
#
# Commit types that trigger automatic versioning:
#   feat:     New feature (bumps MINOR version)
#   fix:      Bug fix (bumps PATCH version)
#   BREAKING: Breaking change (bumps MAJOR version)
#
# Other types (no version bump):
#   docs:     Documentation only
#   style:    Code style changes
#   refactor: Code refactoring
#   test:     Add/update tests
#   chore:    Maintenance tasks
#   perf:     Performance improvements
#   ci:       CI/CD changes
#
# Examples:
#   feat: Add property search API
#   fix(auth): Resolve login timeout issue
#   docs: Update API documentation
#   BREAKING CHANGE: Remove deprecated endpoints
#
# Note: Version will be automatically bumped based on commit type
# Add [skip ci] to skip automation
# Add [no version] to skip version bump
#
# Please remove these comments before committing
EOF
    fi
fi
