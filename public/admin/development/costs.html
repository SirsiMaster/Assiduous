<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Development Costs — Assiduous</title>
    
    <!-- Assiduous Design System -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/@fontsource/geist-sans@5.0.6/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../assiduous.css">
    <link rel="stylesheet" href="../../components/admin-layout.css">
    <link rel="stylesheet" href="../../assets/css/button-override.css">
    
    <style>
        .costs-content {
            padding: var(--space-xl);
            overflow-y: auto;
            background: var(--gray-50);
        }

        /* Section Headers */
        .section-header {
            margin: var(--space-2xl) 0 var(--space-lg) 0;
            padding-bottom: var(--space-md);
            border-bottom: 1px solid var(--border);
        }

        .section-header:first-child {
            margin-top: 0;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--navy);
            margin-bottom: var(--space-xs);
        }

        .section-subtitle {
            font-size: 14px;
            color: var(--text-secondary);
        }

        /* Stats Grid - Fixed Width */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, minmax(200px, 280px));
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }

        .stats-grid-5 {
            display: grid;
            grid-template-columns: repeat(5, minmax(180px, 240px));
            gap: var(--space-md);
            margin-bottom: var(--space-xl);
        }

        .stats-grid-3 {
            display: grid;
            grid-template-columns: repeat(3, minmax(200px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-xl);
        }
        
        @media (max-width: 1200px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }

        .stat-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            transition: all 0.2s;
        }

        .stat-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: var(--space-md);
        }

        .stat-icon.blue { background: rgba(96, 163, 217, 0.1); color: var(--sky); }
        .stat-icon.green { background: rgba(5, 150, 105, 0.1); color: var(--success); }
        .stat-icon.yellow { background: rgba(255, 217, 64, 0.1); color: var(--warning); }
        .stat-icon.purple { background: rgba(139, 92, 246, 0.1); color: #8B5CF6; }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--dark);
            margin-bottom: var(--space-xs);
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.025em;
            margin-bottom: var(--space-sm);
        }

        .stat-change {
            font-size: 12px;
            font-weight: 600;
            color: var(--text-secondary);
        }

        /* Content Grid */
        .content-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: var(--space-xl);
            margin-bottom: var(--space-xl);
        }

        @media (max-width: 1024px) {
            .content-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Data Card */
        .data-card {
            background: var(--white);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            overflow: hidden;
        }

        .card-header {
            padding: var(--space-md) var(--space-lg);
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--dark);
        }

        .card-body {
            padding: var(--space-md);
        }

        .card-body.compact {
            padding: var(--space-sm) var(--space-md);
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            padding: var(--space-sm) var(--space-lg);
            text-align: left;
            font-size: 11px;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            background: var(--gray-50);
            border-bottom: 1px solid var(--border);
        }

        td {
            padding: var(--space-md) var(--space-lg);
            font-size: 14px;
            color: var(--text-primary);
            border-bottom: 1px solid var(--gray-100);
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover {
            background: var(--gray-50);
        }

        /* Progress Bars */
        .progress-bar {
            height: 8px;
            background: var(--gray-200);
            border-radius: 4px;
            overflow: hidden;
            margin-top: var(--space-sm);
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .progress-fill.blue { background: var(--sky); }
        .progress-fill.green { background: var(--success); }
        .progress-fill.yellow { background: var(--warning); }
        .progress-fill.purple { background: #8B5CF6; }
        .progress-fill.gray { background: var(--gray-400); }

        /* Mini Stat */
        .mini-stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--space-sm) 0;
            border-bottom: 1px solid var(--gray-100);
        }

        .mini-stat:last-child {
            border-bottom: none;
        }

        .mini-stat-label {
            font-size: 13px;
            color: var(--text-secondary);
        }

        .mini-stat-value {
            font-size: 15px;
            font-weight: 600;
            color: var(--dark);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
        }
    </style>
</head>
<body>
    <div class="admin-wrapper">
        <!-- Sidebar Component -->
        <div id="sidebar-root" data-active="dev-costs"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header id="universal-header-root" 
                    data-title="Development Costs" 
                    data-subtitle="Time, cost, and efficiency metrics for Assiduous development"
                    data-search-placeholder="Search cost metrics..."></header>

            <!-- Page Content -->
            <div class="page-content costs-content">

                <!-- Cost Overview -->
                <div class="section-header">
                    <h2 class="section-title">Cost Overview</h2>
                    <p class="section-subtitle">Development expenses and budget allocation across the project lifecycle</p>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon blue">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <polyline points="12 6 12 12 16 14"></polyline>
                            </svg>
                        </div>
                        <div class="stat-label">Today's Cost</div>
                        <div class="stat-value" id="todayCost">$1,200</div>
                        <div class="stat-change" id="todayHours">4h 00m worked</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon green">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                        </div>
                        <div class="stat-label">This Week</div>
                        <div class="stat-value" id="weekCost">$1,200</div>
                        <div class="stat-change" id="weekHours">4h • 1 day</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon yellow">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="1" x2="12" y2="23"></line>
                                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                            </svg>
                        </div>
                        <div class="stat-label">This Month</div>
                        <div class="stat-value" id="monthCost">$6,789</div>
                        <div class="stat-change">November 2025</div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon purple">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                                <path d="M2 17l10 5 10-5"></path>
                                <path d="M2 12l10 5 10-5"></path>
                            </svg>
                        </div>
                        <div class="stat-label">Project Total</div>
                        <div class="stat-value" id="totalCost">$7,989</div>
                        <div class="stat-change" id="totalHours">Since Aug 2025</div>
                    </div>
                </div>

                <!-- Time & Velocity Metrics -->
                <div class="section-header">
                    <h2 class="section-title">Time & Velocity Metrics</h2>
                    <p class="section-subtitle">Development hours, productivity, and efficiency tracking</p>
                </div>

                <div class="stats-grid-5">
                    <div class="stat-card">
                        <div class="stat-label">Total Hours</div>
                        <div class="stat-value" id="totalHoursMetric">233.5</div>
                        <div class="stat-change">Project lifetime</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Avg Hours/Day</div>
                        <div class="stat-value" id="avgHoursDay">8.3</div>
                        <div class="stat-change">28 active days</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Commits/Hour</div>
                        <div class="stat-value" id="commitsPerHour">2.95</div>
                        <div class="stat-change">689 total commits</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Cost/Commit</div>
                        <div class="stat-value" id="costPerCommit">$11.59</div>
                        <div class="stat-change">Efficiency metric</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">Cost/Hour</div>
                        <div class="stat-value">$150</div>
                        <div class="stat-change">Current rate</div>
                    </div>
                </div>

                <!-- Cost Breakdown Details -->
                <div class="section-header">
                    <h2 class="section-title">Cost Breakdown & Analysis</h2>
                    <p class="section-subtitle">Detailed expense categorization and spending patterns</p>
                </div>

                <div class="content-grid">
                    <div class="data-card">
                        <div class="card-header">
                            <h3 class="card-title">Cost by Category</h3>
                        </div>
                        <div class="card-body compact">

                    <div class="data-card">
                        <div class="card-header">
                            <h3 class="card-title">Tool & Service Costs</h3>
                        </div>
                        <div class="card-body compact">
                            <div class="mini-stat">
                                <span class="mini-stat-label">Firebase (Spark Plan)</span>
                                <span class="mini-stat-value">$0/mo</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">GitHub (Free Tier)</span>
                                <span class="mini-stat-value">$0/mo</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">Warp AI Credits</span>
                                <span class="mini-stat-value">$650/mo</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">CDN (jsDelivr)</span>
                                <span class="mini-stat-value">$0/mo</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">Domain & SSL</span>
                                <span class="mini-stat-value">$0/mo</span>
                            </div>
                            <div style="margin-top: var(--space-md); padding-top: var(--space-md); border-top: 2px solid var(--border);">
                                <div class="mini-stat">
                                    <span style="font-weight: 600; color: var(--navy);">Total Monthly Tools</span>
                                    <span style="font-size: 18px; font-weight: 700; color: var(--navy);">$650</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Weekly/Monthly Trends -->
                <div class="section-header">
                    <h2 class="section-title">Spending Trends</h2>
                    <p class="section-subtitle">Historical cost patterns and projections</p>
                </div>

                <div class="stats-grid-3">
                    <div class="data-card">
                        <div class="card-header">
                            <h3 class="card-title">Last 7 Days</h3>
                        </div>
                        <div class="card-body compact">
                            <div class="mini-stat">
                                <span class="mini-stat-label">Labor Cost</span>
                                <span class="mini-stat-value" id="week7Labor">$1,200</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">Hours Worked</span>
                                <span class="mini-stat-value" id="week7Hours">8.0h</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">Commits</span>
                                <span class="mini-stat-value" id="week7Commits">24</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">Avg Cost/Day</span>
                                <span class="mini-stat-value" id="week7AvgDay">$171</span>
                            </div>
                        </div>
                    </div>

                    <div class="data-card">
                        <div class="card-header">
                            <h3 class="card-title">Last 30 Days</h3>
                        </div>
                        <div class="card-body compact">
                            <div class="mini-stat">
                                <span class="mini-stat-label">Labor Cost</span>
                                <span class="mini-stat-value" id="month30Labor">$6,789</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">Hours Worked</span>
                                <span class="mini-stat-value" id="month30Hours">45.3h</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">Commits</span>
                                <span class="mini-stat-value" id="month30Commits">134</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">Avg Cost/Day</span>
                                <span class="mini-stat-value" id="month30AvgDay">$226</span>
                            </div>
                        </div>
                    </div>

                    <div class="data-card">
                        <div class="card-header">
                            <h3 class="card-title">Projected</h3>
                        </div>
                        <div class="card-body compact">
                            <div class="mini-stat">
                                <span class="mini-stat-label">Month End Total</span>
                                <span class="mini-stat-value" id="projectedMonth">$8,500</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">Burn Rate/Week</span>
                                <span class="mini-stat-value" id="burnRate">$1,697</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">Days to $10K</span>
                                <span class="mini-stat-value" id="daysTo10k">9 days</span>
                            </div>
                            <div class="mini-stat">
                                <span class="mini-stat-label">Est. Completion</span>
                                <span class="mini-stat-value" id="estCompletion">$12K</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Distribution Breakdown -->
                <div class="section-header">
                    <h2 class="section-title">Cost Distribution</h2>
                    <p class="section-subtitle">How development budget is allocated</p>
                </div>

                <div class="content-grid">
                    <div class="data-card">
                        <div class="card-header">
                            <h3 class="card-title">Expense Categories</h3>
                        </div>
                        <div class="card-body">
                            <div style="margin-bottom: var(--space-lg);">
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-xs);">
                                    <span class="stat-label">Labor Cost</span>
                                    <span style="font-weight: 600;" id="laborPercent">0%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill blue" id="laborBar" style="width: 0%"></div>
                                </div>
                                <div style="font-size: 20px; font-weight: 600; color: var(--navy); margin-top: var(--space-sm);" id="laborCost">$0</div>
                            </div>
                            
                            <div style="margin-bottom: var(--space-lg);">
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-xs);">
                                    <span class="stat-label">Tools & Services</span>
                                    <span style="font-weight: 600;" id="toolsPercent">0%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill green" id="toolsBar" style="width: 0%"></div>
                                </div>
                                <div style="font-size: 20px; font-weight: 600; color: var(--success); margin-top: var(--space-sm);" id="toolsCost">$0</div>
                            </div>
                            
                            <div>
                                <div style="display: flex; justify-content: space-between; margin-bottom: var(--space-xs);">
                                    <span class="stat-label">Cloud Infrastructure</span>
                                    <span style="font-weight: 600;">0%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill gray" style="width: 0%"></div>
                                </div>
                                <div style="font-size: 20px; font-weight: 600; color: var(--gray-400); margin-top: var(--space-sm);">$0</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="section-header">
                    <h2 class="section-title">Recent Activity</h2>
                    <p class="section-subtitle">Latest commits and time entries</p>
                </div>

                <div class="data-card">
                    <table>
                        <thead>
                            <tr>
                                <th>Commit</th>
                                <th>Message</th>
                                <th>Author</th>
                                <th>Time</th>
                            </tr>
                        </thead>
                        <tbody id="activityTable">
                            <tr>
                                <td colspan="4" style="text-align: center; padding: var(--space-xl); color: var(--text-secondary);">
                                    Loading activity...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

            </div>
        </main>
    </div>

    <script>
        function getTimeAgo(date) {
            const seconds = Math.floor((new Date() - date) / 1000);
            if (seconds < 3600) return `${Math.floor(seconds / 60)}m ago`;
            if (seconds < 86400) return `${Math.floor(seconds / 3600)}h ago`;
            if (seconds < 2592000) return `${Math.floor(seconds / 86400)}d ago`;
            return new Date(date).toLocaleDateString();
        }
        
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('Development Costs page loaded');
            
            // Load real metrics from metrics.json
            try {
                const response = await fetch('./metrics.json');
                if (response.ok) {
                    const metrics = await response.json();
                    console.log('Loaded cost metrics:', metrics);
                    
                    // Update cost cards
                    document.getElementById('todayCost').textContent = `$${parseInt(metrics.today?.cost || 0).toLocaleString()}`;
                    document.getElementById('weekCost').textContent = `$${parseInt(metrics.thisWeek?.cost || 0).toLocaleString()}`;
                    document.getElementById('monthCost').textContent = `$${parseInt(metrics.thisMonth?.cost || 0).toLocaleString()}`;
                    document.getElementById('totalCost').textContent = `$${parseInt(metrics.project?.totalCost || 0).toLocaleString()}`;
                    
                    // Update hours
                    document.getElementById('todayHours').textContent = `${metrics.today?.hours || 0}h worked`;
                    document.getElementById('weekHours').textContent = `${metrics.thisWeek?.hours || 0}h • ${metrics.thisWeek?.days || 0} days`;
                    document.getElementById('totalHours').textContent = `Since Aug 2025 • ${metrics.project?.totalHours || 0}h`;
                    
                    // Update cost breakdown
                    const laborCost = metrics.project?.laborCost || 0;
                    const toolsCost = metrics.project?.toolsCost || 0;
                    const totalCost = metrics.project?.totalCost || 1;
                    
                    const laborPct = Math.round((laborCost / totalCost) * 100);
                    const toolsPct = Math.round((toolsCost / totalCost) * 100);
                    
                    document.getElementById('laborCost').textContent = `$${laborCost.toLocaleString()}`;
                    document.getElementById('toolsCost').textContent = `$${toolsCost.toLocaleString()}`;
                    document.getElementById('laborPercent').textContent = `${laborPct}%`;
                    document.getElementById('toolsPercent').textContent = `${toolsPct}%`;
                    document.getElementById('laborBar').style.width = `${laborPct}%`;
                    document.getElementById('toolsBar').style.width = `${toolsPct}%`;
                    
                    // Update recent activity
                    const activityTable = document.getElementById('activityTable');
                    const recentActivity = metrics.recentActivity || [];
                    if (recentActivity.length > 0) {
                        activityTable.innerHTML = recentActivity.slice(0, 10).map(activity => `
                            <tr>
                                <td><code style="font-size: 11px; background: var(--gray-100); padding: 2px 6px; border-radius: 4px;">${activity.hash ? activity.hash.substring(0, 7) : 'N/A'}</code></td>
                                <td>${activity.message || 'No message'}</td>
                                <td>${activity.author || 'Unknown'}</td>
                                <td style="white-space: nowrap;">${activity.date ? getTimeAgo(new Date(activity.date)) : 'Recently'}</td>
                            </tr>
                        `).join('');
                    } else {
                        activityTable.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: var(--space-xl); color: var(--text-secondary);">No recent activity</td></tr>';
                    }
                    
                    console.log('Cost page updated successfully');
                } else {
                    console.warn('Metrics cache not available');
                }
            } catch (error) {
                console.error('Error loading metrics:', error);
            }
        });
    </script>
    
    <!-- Load Component Scripts -->
    <script src="../../components/sidebar.js"></script>
    <script src="../../components/universal-header.js"></script>
</body>
</html>
